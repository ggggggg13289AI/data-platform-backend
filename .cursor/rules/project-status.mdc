# Project Status and Context - Backend Django
# glob pattern(s) for applicable files: "**/*"

## Snapshot
- **Date**: 2025-11-13
- **Repo**: `backend_django`
- **Active branch**: `feature/pagination-unification`

## TL;DR
- **方向**: 從 FastAPI 遷移至 Django + Django Ninja（決策已通過，文件完整）。
- **分頁統一**: 已完成需求與設計審核（Offset/Limit、統一回應格式），進入實作階段並位於當前分支。
- **Projects 功能**: 規劃與設計 100% 完成，後端進入實作起點（已存在模型/服務/API/測試檔雛形）。
- **阻礙**: Projects 功能落地須以分頁統一改造與基礎模型遷移為前置。

## 現況摘要
- 依據 `docs/planning/PROJECT_STATUS_REPORT.md`：
  - Phase 1（FastAPI + DuckDB）已完成；決策遷移到 Django。
  - Phase 2（Django 專案與資料模型）規劃完備，等待/進行中。
- 依據 `docs/backend/PAGINATION_REQUIREMENTS.md` 與 `docs/backend/PAGINATION_DESIGN.md`：
  - 報告 API 已符合 Offset/Limit；研究 API 需從 Page/Size 改為 Offset/Limit。
  - 統一回應格式：`{ items, pagination: { total, offset, limit, page, pages } }`。
- 依據 `_tasks/2025-11-12-projects-route-*`：
  - Projects 路由 22 個端點、模型與權限、服務層均已規格化，提供 7 日落地路線圖與品質關卡。
- 依據工作目錄快照：
  - 出現 `studies/migrations/0007_add_project_models.py`、`studies/permissions.py`、`studies/project_service.py`、`studies/project_api.py`、對應測試檔，顯示 Projects 後端實作已開跑（尚待整合與驗證）。

## 立即優先事項（高→低）
1. 完成研究 API 的 Offset/Limit 分頁改造（`studies/pagination.py`、端點簽名與回應格式統一、測試覆蓋）。
2. 穩定合併 `feature/pagination-unification`，同步更新文件與相容層（如需要）。
3. 推進 Projects 三模型與遷移、服務層、權限、22 個端點與測試，依 7 日路線圖分階段交付。
4. 進行整合測試、效能優化、文件更新與發佈（部署檢查清單）。

## 參考文件（關鍵）
- `docs/planning/PROJECT_STATUS_REPORT.md`
- `docs/backend/PAGINATION_REQUIREMENTS.md`
- `docs/backend/PAGINATION_DESIGN.md`
- `_tasks/2025-11-12-projects-route-specification/*`
- `_tasks/2025-11-12-projects-route-analysis-workflow/*`

## 非目標（此階段不處理）
- 光標分頁（未來 Phase）。
- GraphQL 與前端客戶端庫重寫。
- 超過 6 個月的舊版 API 長期維護。
